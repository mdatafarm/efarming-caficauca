@using EFarming.Core.FarmModule.FarmAggregate
@model EFarming.Core.TasqModule.TASQAssessment


@{
    ViewBag.Title = "New Assessment";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@*<link href="~/Content/bootstrap-select.min.css" rel="stylesheet" />*@
@*<link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">*@
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/css/bootstrap-select.min.css" rel="stylesheet" />

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2 class="page-name">Assessments fill</h2>
        <ol class="breadcrumb">
            <li>
                <a href="@Url.Action("Index", "Contacts")">
                    Sustainability
                </a>
            </li>

            <li class="active">
                <strong>New Assessment</strong>
            </li>
        </ol>
    </div>
</div>

<div class="wrapper wrapper-content">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-md-12">
                            <label>Assesment Type: </label>
                            <span>@ViewBag.Template</span>
                            <input type="hidden" id="hdn_templateID" value="@ViewBag.TemplateID" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">&nbsp;</div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <label>Choose a Farm</label><br />
                            <select id="FarmID" class="form-control selectpicker" data-live-search="true">
                                @if (@ViewBag.Farms != null)
                                {
                                    <option value="-1">Choose a farm...</option>
                                    foreach (Farm f in @ViewBag.Farms)
                                    {
                                        <option value="@f.Id">@f.Code - @f.Name</option>
                                    }
                                }
                            </select>

                        </div>
                        <div class="col-md-4">
                            <label>Description</label><br />
                            <input type="text" id="txt_description" class="form-control" />

                        </div>
                        <div class="col-md-2">
                            <label>Date</label><br />
                            <input type="date" id="txt_date" class="form-control" />

                        </div>
                        <div class="col-md-2">
                            <br />
                            <button id="btn_save_ass" class="btn btn-success btn-sm pull-right">Save assessment</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">&nbsp;</div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">


                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $('.selectpicker').selectpicker();

    });

    $('#btn_save_ass').on('click', function () {

        if ($('#FarmID').val() != "-1" && $('#txt_date').val() != "") {
            window.location.href = '@Url.Content("~/SustainabilityArea/AssessmentFill/SaveAssessment/")' + '?TemplateID=' + $('#hdn_templateID').val() + '&FarmID=' + $('#FarmID').val() + '&Desc=' + $('#txt_description').val() + '&Date=' + $('#txt_date').val();

            //$.ajax({
            //    url: '/SustainabilityArea/AssessmentFill/SaveAssessment/',
            //    type: 'POST',
            //    datatype: 'JSON',
            //    data: { TemplateID: $('#hdn_templateID').val(), FarmID:$('#FarmID').val(), Desc: $('#txt_description').val(), Date: $('#txt_date').val()},
            //    success: function (result) {

            //    },
            //    error: function (result) {
            //        alert('Error, try again');
            //    }
            //});


        }
        else {
            alert("You must select a farm and a date");
        }
    });

</script>